<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Synapse Discovery</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <!-- DISCOVERY SCREEN -->
    <div id="screen-discovery" class="screen active">
      <div class="status-dot searching" id="discovery-dot"></div>
      <h1>Synapse Discovery</h1>
      <p class="profile-name" id="profile-name-display" style="display: none;">
        Profile: <span id="profile-alias-text">-</span>
      </p>
      <p id="discovery-message">üîç Buscando extensi√≥n...</p>
     
      <div class="progress-info" id="discovery-progress">
        Intento: <span id="attempt-count">0</span>
      </div>
     
      <div class="info-section">
        <p id="profile-id">Profile: -</p>
        <p id="profile-alias"></p>
        <p id="timestamp">Estado: Esperando conexi√≥n</p>
      </div>
      <div class="register-notice" id="register-notice" style="display: none;">
        ‚ö†Ô∏è Despu√©s de conectar, se iniciar√° el proceso de registro de Google y Gemini API
      </div>
     
      <div class="auto-close-notice" id="discovery-auto-close">
        ‚úì Conexi√≥n establecida exitosamente<br>
        <small class="countdown-text">Cerrando en <span id="countdown-value">5</span> segundos...</small>
      </div>
     
      <div class="error-container" id="discovery-error">
        <div id="error-message">Error</div>
        <pre id="error-details"></pre>
      </div>
    </div>

    <!-- STEP 0: WELCOME -->
    <div id="screen-onboarding-welcome" class="screen">
      <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
      <div class="step-indicator">Paso 1 de 3</div>
     
      <div class="status-icon">üå∏</div>
      <h1>Bienvenido a Bloom</h1>
      <p>
        Vamos a configurar tu perfil en 2 pasos simples.<br>
        Necesitar√°s una cuenta de Google y crear una API Key de Gemini.
      </p>
     
      <button class="btn" id="btn-start-onboarding">Comenzar</button>
    </div>

    <!-- STEP 1: GOOGLE LOGIN -->
    <div id="screen-google-login" class="screen">
      <div class="progress-bar"><div class="progress-fill" style="width: 33%"></div></div>
      <div class="step-indicator">Paso 2 de 3</div>
     
      <div class="status-icon">üîê</div>
      <h1>Inicia sesi√≥n con Google</h1>
      <p>
        Necesitamos que inicies sesi√≥n en tu cuenta de Google para continuar.
      </p>
     
      <button class="btn" id="btn-google-login">Iniciar sesi√≥n con Google</button>
    </div>

    <!-- STEP 1.5: WAITING FOR LOGIN -->
    <div id="screen-google-waiting" class="screen">
      <div class="progress-bar"><div class="progress-fill" style="width: 33%"></div></div>
      <div class="step-indicator">Paso 2 de 3</div>
     
      <div class="spinner"></div>
      <h1>Esperando inicio de sesi√≥n...</h1>
      <p>
        Completa el inicio de sesi√≥n en la pesta√±a que se abri√≥.<br>
        Detectaremos autom√°ticamente cuando hayas iniciado sesi√≥n.
      </p>
    </div>

    <!-- STEP 2: GEMINI API -->
    <div id="screen-gemini-api" class="screen">
      <div class="progress-bar"><div class="progress-fill" style="width: 66%"></div></div>
      <div class="step-indicator">Paso 3 de 3</div>
     
      <div class="status-icon">üîë</div>
      <h1>Crea tu Gemini API Key</h1>
     
      <div class="info-box">
        <h3>Instrucciones:</h3>
        <ol>
          <li>Haz clic en "Crear API Key" en la nueva pesta√±a</li>
          <li>Copia la clave generada</li>
          <li>La detectaremos autom√°ticamente</li>
        </ol>
      </div>
     
      <button class="btn" id="btn-open-aistudio">Ir a AI Studio</button>
    </div>

    <!-- STEP 2.5: WAITING FOR API KEY -->
    <div id="screen-gemini-waiting" class="screen">
      <div class="progress-bar"><div class="progress-fill" style="width: 66%"></div></div>
      <div class="step-indicator">Paso 3 de 3</div>
     
      <div class="spinner"></div>
      <h1>Esperando API Key...</h1>
      <p>
        Crea y copia tu API Key en AI Studio.<br>
        La detectaremos autom√°ticamente cuando la copies.
      </p>
    </div>

    <!-- STEP 3: SUCCESS -->
    <div id="screen-onboarding-success" class="screen">
      <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
     
      <div class="success-checkmark">‚úì</div>
      <h1>¬°Configuraci√≥n completa!</h1>
      <p>
        Tu perfil est√° listo para usar.<br>
        Esta ventana se cerrar√° autom√°ticamente.
      </p>
     
      <div class="info-box">
        <p><strong>Email:</strong> <span id="final-email">-</span></p>
        <p><strong>API Key:</strong> ‚úì Configurada</p>
      </div>
    </div>
  </div>

  <script src="../discovery.synapse.config.js"></script>
  <script src="discoveryProtocol.js"></script>
  <script src="discovery.js"></script>
</body>
</html>