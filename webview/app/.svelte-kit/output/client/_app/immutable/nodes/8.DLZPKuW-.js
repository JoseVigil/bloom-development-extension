import{A as Ke,S as Le,c as Me}from"../chunks/NGysjSll.js";import{p as Xe,B as Ze,C as U,D as Ue,i as Ve,J as p,I as b,L as z,K as x,d as o,g as et,E as tt,F as _e,h as s,j as n,u as v,t as e,H as A,S as $,G as f,r as a,N as at,X as st,Y as be,P as me,o as I,W as ge,R as V,n as we,c as rt,Z as nt,O as it,m as vt}from"../chunks/OFsEVZk6.js";import{p as ot}from"../chunks/D0JV5-f6.js";import{i as y}from"../chunks/Ch2DEP4i.js";import{B as lt,C as ct}from"../chunks/kHyymk3i.js";import{T as dt}from"../chunks/mbl6RdCr.js";import{g as he}from"../chunks/DiuWRKqr.js";var ut=p('<input type="text" class="title-input svelte-wpa808" placeholder="Intent title"/>'),ft=p("<span>•</span> <span> </span>",1),pt=p('<span class="tab-badge svelte-wpa808"> </span>'),_t=p('<span class="tab-badge svelte-wpa808"> </span>'),bt=p('<div class="step-actions svelte-wpa808"><button class="btn-primary svelte-wpa808">Next: Questions</button></div>'),mt=p("<!> <!>",1),gt=p('<div class="question-item svelte-wpa808"><label class="svelte-wpa808"> </label> <textarea placeholder="Your answer..." rows="3" class="svelte-wpa808"></textarea></div>'),wt=p('<div class="step-actions svelte-wpa808"><button class="btn-primary svelte-wpa808">Next: Refinement</button></div>'),ht=p('<div class="questions svelte-wpa808"></div> <!>',1),xt=p('<div class="editor-meta svelte-wpa808"><span> </span> <span>•</span> <span> </span> <!></div> <div class="editor-body svelte-wpa808"><div class="editor-main svelte-wpa808"><div class="tabs svelte-wpa808"><button>Briefing</button> <button>Questions <!></button> <button>Refinement <!></button></div> <div class="tab-content svelte-wpa808"><!></div></div> <aside class="editor-sidebar svelte-wpa808"><!> <div class="sidebar-section svelte-wpa808"><h3 class="svelte-wpa808">Actions</h3> <button class="btn-success svelte-wpa808">Accept & Finalize</button></div></aside></div>',1),yt=p('<div class="intent-editor svelte-wpa808"><header class="editor-header svelte-wpa808"><div class="header-left svelte-wpa808"><button class="back-btn svelte-wpa808" aria-label="Back to intents"><!></button> <!></div> <div class="header-right svelte-wpa808"><button class="btn-secondary svelte-wpa808" aria-label="Save draft"><!> Save Draft</button> <button class="btn-primary svelte-wpa808" aria-label="Run execution"><!> </button></div></header> <!></div>');function Et(xe,ye){Xe(ye,!1);const ee=()=>_e(ot,"$page",te),B=()=>_e(y,"$intentsStore",te),[te,Se]=tt(),C=A(),t=A(),_=A();let l=A("briefing"),E=A(!1);Ze(async()=>{e(C)==="new"?y.createNew():await y.loadIntent(e(C))});function N(){return e(t)?e(_)==="briefing"?e(t).briefing.problem.length>0:e(_)==="questions"?e(t).questions.filter(w=>w.answer.length>0).length>=3:!0:!1}async function ae(){e(_)==="briefing"&&N()?(y.setWizardState("questions"),f(l,"questions")):e(_)==="questions"&&N()&&(y.setWizardState("refinement"),f(l,"refinement"))}async function ke(){if(e(t)){f(E,!0);try{await y.execute(e(t).id),y.setWizardState("refinement"),f(l,"refinement")}catch(c){console.error("Execution failed:",c)}finally{f(E,!1)}}}async function $e(){e(t)&&(await y.finalize(e(t).id),he("/intents"))}U(()=>ee(),()=>{f(C,ee().params.id)}),U(()=>B(),()=>{f(t,B().current)}),U(()=>B(),()=>{f(_,B().wizardState)}),Ue(),Ve();var D=yt(),J=s(D),O=s(J),T=s(O),qe=s(T);Ke(qe,{size:20}),a(T);var ze=n(T,2);{var Ie=c=>{var w=ut();st(w),be(w,()=>e(t).title,P=>me(t,e(t).title=P)),o(c,w)};b(ze,c=>{e(t)&&c(Ie)})}a(O);var se=n(O,2),Q=s(se),Be=s(Q);Le(Be,{size:16}),at(),a(Q);var W=n(Q,2),re=s(W);Me(re,{size:16});var Ee=n(re);a(W),a(se),a(J);var Ne=n(J,2);{var Pe=c=>{var w=xt(),P=I(w),Y=s(P),Re=s(Y);a(Y);var G=n(Y,4),Fe=s(G);a(G);var Ae=n(G,2);{var Te=r=>{var i=ft(),u=n(I(i),2),m=s(u);a(u),z(()=>$(m,`Derived from: ${e(t),v(()=>e(t).derivedFrom)??""}`)),o(r,i)};b(Ae,r=>{e(t),v(()=>e(t).derivedFrom)&&r(Te)})}a(P);var ne=n(P,2),H=s(ne),K=s(H),j=s(K);let ie;var q=n(j,2);let ve;var We=n(s(q));{var je=r=>{var i=pt(),u=s(i);a(i),z(m=>$(u,`${m??""}/5`),[()=>(e(t),v(()=>e(t).questions.filter(m=>m.answer).length))]),o(r,i)};b(We,r=>{e(t),v(()=>e(t).questions.some(i=>i.answer))&&r(je)})}a(q);var R=n(q,2);let oe;var Ce=n(s(R));{var De=r=>{var i=_t(),u=s(i,!0);a(i),z(()=>$(u,(e(t),v(()=>e(t).turns.length)))),o(r,i)};b(Ce,r=>{e(t),v(()=>e(t).turns&&e(t).turns.length>0)&&r(De)})}a(R),a(K);var le=n(K,2),Je=s(le);{var Oe=r=>{var i=mt(),u=I(i);lt(u,{get briefing(){return e(t).briefing},set briefing(d){me(t,e(t).briefing=d)},$$legacy:!0});var m=n(u,2);{var L=d=>{var g=bt(),S=s(g);a(g),x("click",S,ae),o(d,g)};b(m,d=>{v(N)&&d(L)})}o(r,i)},Qe=r=>{var i=we(),u=I(i);{var m=d=>{var g=ht(),S=I(g);rt(S,5,()=>(e(t),v(()=>e(t).questions)),vt,(k,h,fe)=>{var X=gt(),Z=s(X),Ge=s(Z,!0);a(Z);var pe=n(Z,2);nt(pe),a(X),z(()=>$(Ge,(e(h),v(()=>e(h).label)))),be(pe,()=>e(h).answer,He=>(e(h).answer=He,it(()=>(e(t),B())))),o(k,X)}),a(S);var M=n(S,2);{var F=k=>{var h=wt(),fe=s(h);a(h),x("click",fe,ae),o(k,h)};b(M,k=>{v(N)&&k(F)})}o(d,g)},L=d=>{var g=we(),S=I(g);{var M=F=>{{let k=ge(()=>(e(t),v(()=>e(t).turns||[])));ct(F,{get turns(){return e(k)},get intentId(){return e(t),v(()=>e(t).id)}})}};b(S,F=>{e(l)==="refinement"&&F(M)},!0)}o(d,g)};b(u,d=>{e(l)==="questions"?d(m):d(L,!1)},!0)}o(r,i)};b(Je,r=>{e(l)==="briefing"?r(Oe):r(Qe,!1)})}a(le),a(H);var ce=n(H,2),de=s(ce);{let r=ge(()=>(e(t),v(()=>JSON.stringify(e(t).briefing))));dt(de,{get content(){return e(r)}})}var ue=n(de,2),Ye=n(s(ue),2);a(ue),a(ce),a(ne),z(()=>{$(Re,`Profile: ${e(t),v(()=>e(t).profile)??""}`),$(Fe,`Project: ${e(t),v(()=>e(t).project||"None")??""}`),ie=V(j,1,"tab svelte-wpa808",null,ie,{active:e(l)==="briefing"}),j.disabled=e(_)!=="briefing"&&e(_)!=="questions"&&e(_)!=="refinement",ve=V(q,1,"tab svelte-wpa808",null,ve,{active:e(l)==="questions"}),q.disabled=e(_)==="briefing",oe=V(R,1,"tab svelte-wpa808",null,oe,{active:e(l)==="refinement"}),R.disabled=e(_)!=="refinement"}),x("click",j,()=>f(l,"briefing")),x("click",q,()=>f(l,"questions")),x("click",R,()=>f(l,"refinement")),x("click",Ye,$e),o(c,w)};b(Ne,c=>{e(t)&&c(Pe)})}a(D),z(c=>{W.disabled=c,$(Ee,` ${e(E)?"Running...":"Run Execution"}`)},[()=>(e(E),v(()=>e(E)||!N()))]),x("click",T,()=>he("/intents")),x("click",W,ke),o(xe,D),et(),Se()}export{Et as component};
